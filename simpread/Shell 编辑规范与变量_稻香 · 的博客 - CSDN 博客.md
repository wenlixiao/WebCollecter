> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [blog.csdn.net](https://blog.csdn.net/weixin_67479400/article/details/124557312)

**目录**

[一. Shell 脚本的概述](#t0)

[1. Shell 脚本的概念.](#t1)

[2. Shell 脚本应用场景](#t2)

[3. Shell 脚本的作用](#t3)

[二. Shell 编程规范](#t4)

[1. 用户登录 Shell](#t5)

[2. 编写 Shell 脚本](#t6)

[2.1 编写脚本代码](#t7)

[2.2 赋予可执行权限](#t8)

[2.3 执行脚本文件](#t9)

[2.4 更完善的脚本构成](#t10)

[3. 重定向](#t11)

[3.1 交互式硬件设备](#t12)

[3.2 重定向操作](#t13)

[3.3 管道操作](#t14)

[三. Shell 脚本变量](#t15)

[1. 变量的作用](#t16)

[2. 变量的类型](#t17)

[3. 自定义变量](#t18)

[3.1 定义一个新的变量](#t19)

[3.2 查看变量的值](#t20)

[3.3  赋值时使用引号](#t21)

[3.4  read](#t22)

[3.5. export](#t23)

[3.6 整数变量的运算](#t24)

[四. 特殊的 Shell 变量](#t25)

[1. 环境变量](#t26)

[2. 常见的环境变量](#t27)

[3. 只读变量](#t28)

[4. 位置变量](#t29)

[5. 预定义变量](#t30)

一. Shell 脚本的概述
==============

1. Shell 脚本的概念.
---------------

*   将要执行的命令按顺序保存到一个文本文件
*   给该文件可执行权限
*   可结合各种 Shell 控制语句以完成更复杂的操作

2. Shell 脚本应用场景
---------------

*   重复性操作
*   交互性任务
*   批量事务处理
*   服务运行状态监控
*   定时任务执行

3. Shell 脚本的作用
--------------

*   shell 是一个特殊的应用程序，它介于操作系统内核和用户之间
*   充当了一个 “翻译官” 的角色
*   负责接收用户输入的操作指令并进行解释
*   将需要执行的操作传递给内核执行，并输出执行结果

二. Shell 编程规范
=============

1. 用户登录 Shell
-------------

*   登录后默认使用的 Shell 程序，一般为 / bin/bash
*   不同 Shell 的内部指令、运行环境等会有所区别

![](https://img-blog.csdnimg.cn/2a1e585a805542c8aff291e9cfbd0894.png)

2. 编写 Shell 脚本
--------------

### 2.1 编写脚本代码

*   使用 vim 文本编辑器
*   每行一条 Linux 命令, 按执行顺序依次编写
*   第一行为 “#!/bin/bash”，表示此行一下的代码语句是通过 / bin/bash 程序来结实执行
*   #!/bin/bash 为默认解释器，还有其他类型的解释器，比如 #!/usr/bin/python、#!/usr/bin/expect

![](https://img-blog.csdnimg.cn/ebf85c4d25d44aa2b5b006e3c1c50b4b.png)

### 2.2 赋予可执行权限

*   使脚本具有可执行属性

![](https://img-blog.csdnimg.cn/e887698bac6e41caa2b801cbca183aeb.png)

### 2.3 执行脚本文件

**方法一：**脚本文件路径 (绝对路径与相对路径)

[root@xlj1~]# ./first.sh              （ 必须有 x 权限）上图所示👆

**方法二：** sh 脚本文件路径

[root@xlj1~]# sh first.sh

**方法三：**source 脚本文件路径

[root@xlj1~]# source first.sh    （也可以通过 “." 来执行）

### 2.4 更完善的脚本构成

*   脚本声明
*   注释信息
*   可执行语句

![](https://img-blog.csdnimg.cn/0d7de3aa42574a56a2e4cfcf1e844114.png)

3. 重定向
------

### 3.1 交互式硬件设备

标准输入: 从该设备接收用户输入的数据

标准输出: 通过该设备向用户输出数据

标准错误: 通过该设备报告执行出错信息

<table border="1" cellpadding="1" cellspacing="1"><thead><tr><th>类型</th><th>设备文件</th><th>文件描述编号</th><th>默认设备</th></tr></thead><tbody><tr><td>标准输入</td><td>/dev/stdin</td><td>0</td><td>键盘</td></tr><tr><td>标准输出</td><td>/dev/stdout</td><td>1</td><td>显示器</td></tr><tr><td>标准错误输出</td><td>/dev/stderr</td><td>2</td><td>显示器</td></tr></tbody></table>

### 3.2 重定向操作

<table border="1" cellpadding="1" cellspacing="1"><thead><tr><th>类型</th><th>操作符</th><th>用途</th></tr></thead><tbody><tr><td>重定向输入</td><td>&lt;</td><td>从指定的文件读取数据, 而不是从键盘输入</td></tr><tr><td colspan="1" rowspan="2">重定向输出</td><td>&gt;</td><td>将输出结果保存到指定的文件 (覆盖原有内容)</td></tr><tr><td>&gt;&gt;</td><td>将输出结果追加到指定的文件尾部</td></tr><tr><td colspan="1" rowspan="2">标准错误输出</td><td>2&gt;</td><td>将错误信息保存到指定的文件 (覆盖原有内容)</td></tr><tr><td>2&gt;&gt;</td><td>将错误信息追加到指定的文件中</td></tr><tr><td>混合输出</td><td>&amp;&gt;</td><td>将标准输出、标准错误的内容保存到同一个文件中</td></tr></tbody></table>

**示例 1**

![](https://img-blog.csdnimg.cn/016e7b7e5b894274a2c99ecf17d2b656.png)

 **示例 2**

> 2>/dev/null          ## 把错误输出到黑洞   
> 
> >/dev/null 2>&1  ## 标准输出重定向到黑洞，错误输出 2 重定向到标准输出（标准输出和错误    输出都到黑洞）
> 
> 2>&1>/dev/null   ## 错误输出重定向到标准输出，标准输出进黑洞

### 3.3 管道操作

管道操作符号 "|"

将左侧的命令输出结果，作为右侧命令的处理对象

![](https://img-blog.csdnimg.cn/350cb0bba1894d2ba3ae12dbf530a97d.png)

三. Shell 脚本变量
=============

1. 变量的作用
--------

用来存放系统和用户需要使用的特定参数 (值)

*   变量名：使用固定的名称，由系统预设或用户定义
*   变量值：能够根据用户设置、系统环境的变化而变化

2. 变量的类型
--------

自定义变量：由用户自己定义、修改和使用

特殊变量：环境变量，只读变量，位置变量，预定义变量

3. 自定义变量
--------

### 3.1 定义一个新的变量

变量名以字母或下划线开头，区分大小写，建议全大写

> 格式：变量名 = 变量值
> 
> [root@xlj1 ~]# test=1234

### 3.2 查看变量的值

> 格式：echo $ 变量名

![](https://img-blog.csdnimg.cn/52d1d266b4a04221bc95d4651462a6af.png)

### 3.3  赋值时使用引号

*   双引号：允许通过 $ 符号引用其他变量值
*   单引号：禁止引用其他变量值，$ 视为普通字符
*   反撇号：命令替换，提取命令执行后的输出结果

![](https://img-blog.csdnimg.cn/7627ff3839024f35a5d5539c4a015b3a.png)

### 3.4  read

从键盘输入内容为变量赋值

示例 1

![](https://img-blog.csdnimg.cn/e663bbd003e94db5a20f2421fcff9e16.png)

 示例 2

![](https://img-blog.csdnimg.cn/e8dc73fdd10443c48ad5494a02e069c5.png)

### 3.5. export

设置变量的作业范围

示例

![](https://img-blog.csdnimg.cn/5874266f74524b97bab426992acd1c10.png)

### 3.6 整数变量的运算

常用运算符

*   加法运算：+
*   减法运算：-
*   乘法运算：\*
*   除法运算：/
*   求模 (取余) 运算：%

示例 1

![](https://img-blog.csdnimg.cn/31bacd6db12a4acdba63ade025905c39.png)

四. 特殊的 Shell 变量
===============

1. 环境变量
-------

指的是出于运行需要而由 Linux 系统提前创建的一类变量，主要用于设置用户的工作环境，包括用户宿主目录、命令查找路径、用户当前目录、登录终端等。

环境变量由 Linux 系统自动维护，会随着用户状态的改变而改变

*   由系统提前创建，用来设置用户的工作环境
*   配置文件：/etc/profile，~/.bash_profile

2. 常见的环境变量
----------

*   PWD，PATH
*   USER，SHELL，HOME

可通过 “env” 命令 进行查看

![](https://img-blog.csdnimg.cn/95fd8801694c4201a113a811b6dfa27c.png)

3. 只读变量
-------

用于变量值不允许被修改的情况

![](https://img-blog.csdnimg.cn/84f45301a68645a9988c04c645d1bd71.png)

4. 位置变量
-------

表示为 $n，n 为 1~9 之间的数字

![](https://img-blog.csdnimg.cn/23b489cc481c439086956f312fbe1353.png)

5. 预定义变量
--------

预定义变量是由 Bash 程序预先定义好的一类特殊变量，用户只能使用预定义变量，而不能创建新的预定义变量，也不能直接为预定义变量赋值。预定义变量使用 "$" 符号和另一个符号组合表示

*   $#：表示命令行中位置参数的个数。
*   $*：表示所有位置参数的内容，这些内容当做一个整体
*   $e：表示列出所有位置参数，但是是以单个的形式的列出
*   $?：表示前一条命令执行后的返回状态，返回值为 0 表示执行正确，返回任何非 0 值均表示执行出现异常
*   $0：表示当前执行的脚本或程序的名称
*   $$：表示返回当前进程的进程号
*   $!：返回最后一个后台进程的进程号

总结
==